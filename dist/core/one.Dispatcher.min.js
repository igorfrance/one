var Dispatcher=Prototype.extend(function(){this.__events=[],this.__listeners={};for(var a=0;a<arguments.length;a++)this.registerEvent(arguments[a])});Dispatcher.prototype.registerEvent=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];this.hasEvent(b)||(this.__events.push(b),this.__listeners[b]=[])}},Dispatcher.prototype.hasEvent=function(a){return this.__events.contains(a)},Dispatcher.prototype.hasListener=function(a,b){if(this.hasEvent(a))for(var c=0;c<this.__listeners[a].length;c++)if(this.__listeners[a][c]==b)return!0;return!1},Dispatcher.prototype.addListener=function(a,b){return this.hasEvent(a)?this.hasListener(a,b)||this.__listeners[a].push(b):$log.error("Did not add event '{0}' because the current object only supports '{1}'",a,this.__events.join(", ")),this},Dispatcher.prototype.on=Dispatcher.prototype.addListener,Dispatcher.prototype.removeListener=function(a,b){if(this.hasEvent(a))if($type.isFunction(b)){for(var c=0;c<this.__listeners[a].length;c++)if(this.__listeners[a][c]==b)return this.__listeners[a].splice(c,1),this}else this.__listeners[a]=[];return this},Dispatcher.prototype.off=Dispatcher.prototype.removeListener,Dispatcher.prototype.destroy=function(){for(var a in this.__listeners)this.off(a)},Dispatcher.prototype.fireEvent=function(a,b){var c=null,d=null;$type.instanceOf(a,$evt.Event)?(d=a.type,c=a):(null==b&&(b=this.createEventData()),d=a,c=new $evt.Event(this,d,b));var e=this.__listeners[d];if(null!=e&&0!=e.length){for(var f=0;f<e.length&&(!$type.isFunction(e[f])||(e[f](c),!c.cancel));f++);return c}return null},Dispatcher.prototype.fire=Dispatcher.prototype.fireEvent,Dispatcher.prototype.createEventData=function(a){return{}},Dispatcher.prototype.toString=function(){var a=[];for(var b in this.__listeners)this.__listeners.hasOwnProperty(b)&&a.push("{0}: {1} listeners".format(b,this.__listeners[b].length));return"Dispatcher: {{0}}".format(a.join(", "))};